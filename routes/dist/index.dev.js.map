{"version":3,"sources":["index.js"],"names":["express","require","router","Router","XLSX","pdfMakePrinter","JsBarcode","Canvas","path","get","req","res","next","render","title","post","workbook","readFile","sheet_name_list","SheetNames","doc","utils","sheet_to_json","Sheets","send","filtered","filter","value","IRMS","GCAS","matertialList","material","body","PO","batch","prdDate","quantity","quantity1","quantity2","quantity3","quantity4","quantity5","quantity6","quantity7","__dirname","IRMSGCAS","parseInt","length","dataFormated","row1Text","row2Text","row3Text","GenerateBarCodeForNumber","then","image1","image2","image3","lotNumber","rowImage1","png","number","rowImage2","rowImage3","generatePdf","formatPDFWithData","cb","contentType","error","err","Username","username","Password","pass","status","docDefinition","callback","fonts","Roboto","normal","join","bold","italics","bolditalics","printer","createPdfKitDocument","chunks","on","chunk","push","result","Buffer","concat","end","Promise","resolve","reject","canvas","format","displayValue","toDataURL","data","formatPDF","pageMargins","pageSize","width","height","content","style","table","widths","text","Suppliername","align","Supplierlocation","Supplierproduct","margin","MaterialDescription","color","colSpan","WIDTH","ROLLDIAMETER","BASISWEIGHT","manROLLSBLOCKS","stack","image","styles","header","fontSize","subheader","tableExample","tableHeader","defaultStyle","module","exports"],"mappings":"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","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst XLSX = require('xlsx')\r\nconst pdfMakePrinter = require('pdfmake/src/printer');\r\n\r\nconst JsBarcode = require('jsbarcode');\r\nconst { Canvas } = require(\"canvas\");\r\n\r\nconst path = require('path');\r\n\r\n/* GET home page. */\r\nrouter.get('/', function (req, res, next) {\r\n\tres.render('home', { title: 'Express' });\r\n});\r\n\r\n/* GET home page. */\r\nrouter.get('/go', function (req, res, next) {\r\n\tres.render('Materialdetail', { title: 'Express' });\r\n});\r\n\r\n\r\n\r\n\r\n/* GET users listing. */\r\n\r\nrouter.post('/receivexlxs', function (req, res, next) {\r\n\tvar workbook = XLSX.readFile('BarcodeGenerator/public/spreadsheets/Plant_001_masterdata.xlsx');\r\n\tvar sheet_name_list = workbook.SheetNames;\r\n\t//var 1`lfdcmsvg vfdc©grwMV  XIZHZGJB NEFWW  = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]]);\r\n\tvar doc = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]]);\r\n\tres.send('respond with a resource');\r\n});\r\n\r\n// router.post('/submitLogin', function (req, res, next) {\r\n\t// res.render(\"index\", null);\r\n// });\r\n\r\nrouter.post('/submitLogin', function (req, res, next) {\r\n\tres.render(\"Materialdetail\", null);\r\n});\r\n\r\n\r\n\r\n\r\nrouter.post('/getcodes', function (req, res, next) {\r\n\tvar workbook = XLSX.readFile('BarcodeGenerator/public/spreadsheets/Plant_001_masterdata.xlsx');\r\n\tvar sheet_name_list = workbook.SheetNames;\r\n\t//var 1`lfdcmsvg vfdc©grwMV  XIZHZGJB NEFWW  = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]]);\r\n\tvar doc = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]]);\r\n\r\n\tvar filtered = doc.filter(function (value) { return value.IRMS / GCAS === '91238465' });\r\n\r\n\tres.render(\"QRCodes\", { title: 'list', matertialList: doc });\r\n});\r\n\r\n\r\nrouter.post('/generatepdf', function (req, res, next) {\r\n\tconst material = req.body.material;\r\n\tconst PO = req.body.PO;\r\n\tconst batch = req.body.batch;\r\n\tconst prdDate = req.body.prdDate;\r\n\tconst quantity = req.body.quantity;\r\n\tconst quantity1 = req.body.quantity1;\r\n\tconst quantity2 = req.body.quantity2;\r\n\tconst quantity3 = req.body.quantity3;\r\n\tconst quantity4 = req.body.quantity4;\r\n\tconst quantity5 = req.body.quantity5;\r\n\tconst quantity6 = req.body.quantity6;\r\n\tconst quantity7 = req.body.quantity7;\r\n\r\n\tvar workbook = XLSX.readFile(__dirname + '/Plant_001_masterdata.xlsx');\r\n\t//var workbook = XLSX.readFile(__dirname + '/My First Project-087f0a546d01.json');\r\n\tvar sheet_name_list = workbook.SheetNames;\r\n\r\n\tvar doc = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]]);\r\n\r\n\tvar filtered = doc.filter(function (value) { return value.IRMSGCAS === parseInt(material) });\r\n\tif(filtered.length <= 0) {\r\n\t\tres.render('Materialdetail')\r\n\t}\r\n\telse{\r\n\r\n\t\tconst dataFormated = filtered[0];\r\n\r\n\t\tconst row1Text = `(91) ${dataFormated.IRMSGCAS}(37)${quantity}`;\r\n\t\tconst row2Text = `(10)AHNL${batch}~(90)NONE`;\r\n\t\tconst row3Text = `(00) 1 1534145 40011${quantity6} 9`;\r\n\r\n\t\tGenerateBarCodeForNumber(`91${dataFormated.IRMSGCAS}37${quantity}`).then(image1=>{\r\n\t\t\tGenerateBarCodeForNumber(`10AHNL${batch}90`).then(image2=>{\r\n\t\t\t\tGenerateBarCodeForNumber(`001153414540011${quantity6}9`).then(image3=>{\r\n\t\t\t\t\t\r\n\t\t\t\t\tdataFormated.lotNumber = batch;\r\n\t\t\t\t\tdataFormated.prdDate = prdDate;\r\n\t\t\t\t\tdataFormated.quantity = quantity;\r\n\t\t\t\t\tdataFormated.quantity1 = quantity1;\r\n\t\t\t\t\tdataFormated.quantity2 = quantity2;\r\n\t\t\t\t\tdataFormated.quantity3 = quantity3;\r\n\t\t\t\t\tdataFormated.quantity4 = quantity4;\r\n\t\t\t\t\tdataFormated.quantity5 = quantity5;\r\n\t\t\t\t\tdataFormated.quantity6 = quantity6;\r\n\t\t\t\t\tdataFormated.quantity7 = quantity7;\r\n\t\t\t\t\tdataFormated.PO = PO;\r\n\t\t\t\t\tdataFormated.rowImage1 = {png:image1, number: row1Text};\r\n\t\t\t\t\tdataFormated.rowImage2 = {png:image2, number: row2Text};\r\n\t\t\t\t\tdataFormated.rowImage3 = {png:image3, number: row3Text};\r\n\t\t\t\t\r\n\t\t\t\t\tgeneratePdf(formatPDFWithData(filtered[0]), cb => {\r\n\t\t\t\t\t\tres.contentType(\"application/pdf\");\r\n\t\t\t\t\t\tres.send(cb);\r\n\t\t\t\t\t});\r\n\t\t\t\r\n\t\t\t\t}).catch(error =>\r\n\t\t\t\t\t{});\r\n\t\t\t}).catch(err =>{});\r\n\t\t}).catch(err =>{});\r\n\t}\r\n});\r\n\r\nrouter.post('/login', (req, res) => {\r\n\r\n\tvar workbook = XLSX.readFile(__dirname + '/Plant_userdata.xlsx');\r\n\tvar doc = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);\r\n\r\n\tvar filtered = doc.filter(value => {\r\n\r\n\t\treturn value.Username == req.body.username\r\n\t}\r\n\t);\r\n\r\n\tif (filtered.length > 0) {\r\n\t\tif (filtered[0].Password == req.body.pass) {\r\n\t\t\tres.render('Materialdetail');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tres.status(401).render('home');\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tres.status(401).render('home');\r\n\t}\r\n});\r\n\r\nfunction generatePdf(docDefinition, callback) {\r\n\r\n\ttry {\r\n\t\tvar fonts = {\r\n\t\t\tRoboto: {\r\n\t\t\t\tnormal: path.join(__dirname, './../fonts/Roboto-Regular.ttf'),\r\n\t\t\t\tbold: path.join(__dirname, './../fonts/Roboto-Medium.ttf'),\r\n\t\t\t\titalics: path.join(__dirname, './../fonts/Roboto-Italic.ttf'),\r\n\t\t\t\tbolditalics: path.join(__dirname, './../fonts/Roboto-Italic.ttf')\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst printer = new pdfMakePrinter(fonts);\r\n\t\tconst doc = printer.createPdfKitDocument(docDefinition);\r\n\r\n\t\tlet chunks = [];\r\n\r\n\t\tdoc.on('data', (chunk) => {\r\n\t\t\tchunks.push(chunk);\r\n\t\t});\r\n\r\n\t\tdoc.on('end', () => {\r\n\t\t\tconst result = Buffer.concat(chunks);\r\n\t\t\tcallback(result);\r\n\t\t});\r\n\r\n\t\tdoc.end();\r\n\r\n\t} catch (err) {\r\n\t\tthrow (err);\r\n\t}\r\n};\r\n\r\n\r\nfunction GenerateBarCodeForNumber(number){\r\n\treturn new Promise((resolve, reject)=>{\r\n\t\tconst canvas = new Canvas();\r\n\t\tJsBarcode(canvas, number, {format:\"CODE128\",  displayValue: false});\t\r\n\t\tcanvas.toDataURL((err, png) => { \r\n\t\t\tif(err){\r\n\t\t\t\treject(err)\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tresolve(png);\r\n\t\t\t}\r\n\t\t});\r\n\t})\r\n}\r\n\r\n\r\nfunction formatPDFWithData(data) {\r\n\tconst formatPDF = {\r\n\t\tpageMargins: [ 5, 5, 5, 5 ],\r\n\t\tpageSize: {width: 440.28, height: 'auto'},\r\n\t\tcontent: [\r\n\t\t\t{\r\n\t\t\t\tstyle: 'tableExample',\r\n\t\t\t\ttable: {\r\n\t\t\t\t\twidths: ['*', '*' ],\r\n\t\t\t\t\tbody: [\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: data.Suppliername, style: 'subheader', align: 'right',text: data.Supplierlocation, style: 'subheader', margin: [35, 0, 10, 0] }\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `Supplier Product: ${data.Supplierproduct}`, style: 'subheader', margin: [25, 0, 10, 0] },\r\n\t\t\t\t\t\t\t\t{ text: `IRMS GCAS: ${data.IRMSGCAS}`, style: 'subheader', margin: [25, 0, 10, 0] },\r\n\t\t\t\t\t\t\t\t{ text: `Prod Date: ${data.prdDate}`, style: 'subheader', margin: [25, 0, 10, 0] }\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t{ text: `ITEM: ${data.MaterialDescription}`, style: 'subheader', color: 'black', align: 'right', colSpan: 2 },\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `WIDTH (MM):                 HEIGHT (MM):          ${data.WIDTH}                   \t\t\t\t   ${data.quantity1} `, style: 'subheader' },\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text:`GROSS wt.(KG):          NET wt.(KG):           ${data.quantity2}                   \t\t\t\t   ${data.quantity3}`, style: 'subheader' },\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t],\r\n\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `ROLL Dia(MM):      ROLLS(BLK)(MM):   ${data.ROLLDIAMETER}               \t\t\t\t   ${data.quantity4} `, style: 'subheader' },\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text:`SPLICES:          BASIS WEIGHT(GSM):           ${data.quantity5}                   \t\t\t\t   ${data.BASISWEIGHT} `, style: 'subheader' },\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t],\r\n\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `IRMS GCAS#: ${data.IRMSGCAS}`, style: 'subheader' },\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `QUANTITY: ${data.quantity} ${data.manROLLSBLOCKS}`, style: 'subheader' },\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `LOT#: AHNL${data.lotNumber}`, style: 'subheader' },\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `PO: ${data.PO}`, style: 'subheader' },\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `CUSTOMER REF.: `, style: 'subheader' },\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t{ text: `PALLETS / BUNDLE : ${data.quantity6}`, style: 'subheader' },\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t{stack:[\r\n\t\t\t\t\t\t\t\t{ image: data.rowImage1.png, width: 200, height: 65},\r\n\t\t\t\t\t\t\t\t{ text: data.rowImage1.number, style: 'subheader', margin: [10, 0, 10, 0] }\r\n\t\t\t\t\t\t\t], colSpan:2, margin: [100, 0, 10, 0] }\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t{stack:[\r\n\t\t\t\t\t\t\t\t{ image: data.rowImage2.png, width: 200, height: 65},\r\n\t\t\t\t\t\t\t\t{ text: data.rowImage2.number, style: 'subheader', margin: [10, 0, 10, 0] }\r\n\t\t\t\t\t\t\t], colSpan:2, margin: [100, 0, 10, 0] }\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t{stack:[\r\n\t\t\t\t\t\t\t\t{ image: data.rowImage3.png, width: 200, height: 65},\r\n\t\t\t\t\t\t\t\t{ text: data.rowImage3.number, style: 'subheader', margin: [10, 0, 10, 0] }\r\n\t\t\t\t\t\t\t], colSpan:2, margin: [100, 0, 10, 0] }\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t],\r\n\r\n\t\tstyles: {\r\n\t\t\theader: {\r\n\t\t\t\tfontSize: 14,\r\n\t\t\t\tbold: true,\r\n\t\t\t\tmargin: [0, 0, 0, 10]\r\n\t\t\t},\r\n\t\t\tsubheader: {\r\n\t\t\t\tfontSize: 12,\r\n\t\t\t\tbold: true,\r\n\t\t\t\tmargin: [0, 10, 0, 5]\r\n\t\t\t},\r\n\t\t\ttableExample: {\r\n\t\t\t\tmargin: [0, 0, 0, -10]\r\n\t\t\t},\r\n\t\t\ttableHeader: {\r\n\t\t\t\tbold: true,\r\n\t\t\t\tfontSize: 9,\r\n\t\t\t\tcolor: 'black'\r\n\t\t\t}\r\n\t\t},\r\n\t\tdefaultStyle: {\r\n\t\t\t// alignment: 'justify'\r\n\t\t}\r\n\t};\r\n\r\n\treturn formatPDF;\r\n}\r\n\r\nmodule.exports = router;"],"file":"index.dev.js"}